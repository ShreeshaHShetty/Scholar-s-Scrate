<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scholars Crate - Sign Up</title>
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/form.css">
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    .password-field {
      position: relative;
    }
    
    .password-field input {
      padding-right: 30px; /* Create space for the icon */
    }

    .toggle-password {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="form-card">
      <div class="form-header">
        <h2>Join Scholars Crate</h2>
        <p>Create your account to discover scholarship opportunities</p>
      </div>

      <form id="signupForm" class="signup-form">
        <div class="form-grid">
          <!-- Full Name -->
          <div class="form-field span-2">
            <label>
              <i data-lucide="user"></i>
              Full Name
            </label>
            <input 
              type="text" 
              name="fullName" 
              required 
              minlength="3"
              placeholder="Enter your full name">
          </div>

          <!-- Date of Birth -->
          <div class="form-field">
            <label>
              <i data-lucide="calendar"></i>
              Date of Birth
            </label>
            <input 
              type="date" 
              name="dateOfBirth" 
              required>
          </div>

          <!-- Age -->
          <div class="form-field">
            <label>
              <i data-lucide="users"></i>
              Age
            </label>
            <input 
              type="text" 
              name="age" 
              readonly>
          </div>

          <!-- Phone Number -->
          <div class="form-field">
            <label>
              <i data-lucide="phone"></i>
              Phone Number
            </label>
            <input 
              type="tel" 
              name="phoneNumber" 
              required 
              pattern="^\+91[0-9]{10}$"
              placeholder="+91XXXXXXXXXX">
          </div>

          <!-- Email -->
          <div class="form-field">
            <label>
              <i data-lucide="mail"></i>
              Email
            </label>
            <input 
              type="email" 
              name="email" 
              required
              placeholder="you@example.com">
          </div>

          <!-- Current Level of Education -->
          <div class="form-field">
            <label>
              <i data-lucide="graduation-cap"></i>
              Current Level of Education
            </label>
            <select name="educationLevel" required>
              <option value="">Select education level</option>
              <option value="highSchool">High School</option>
              <option value="undergraduate">Undergraduate</option>
              <option value="postgraduate">Postgraduate</option>
            </select>
          </div>

          <!-- Annual Income -->
          <div class="form-field">
            <label>
              <i data-lucide="wallet"></i>
              Annual Income
            </label>
            <input 
              type="number" 
              name="income" 
              required
              placeholder="Annual income in INR">
          </div>

          <!-- Gender -->
          <div class="form-field">
            <label>
              <i data-lucide="users"></i>
              Gender
            </label>
            <select name="gender" required>
              <option value="">Select gender</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>
          </div>

          <!-- Religion -->
          <div class="form-field">
            <label>
              <i data-lucide="church"></i>
              Religion
            </label>
            <input 
              type="text" 
              name="religion" 
              required
              placeholder="Enter your religion">
          </div>

          <!-- Caste -->
          <div class="form-field">
            <label>
              <i data-lucide="building-2"></i>
              Caste
            </label>
            <input 
              type="text" 
              name="caste" 
              required
              placeholder="Enter your caste">
          </div>

          <!-- State -->
          <div class="form-field">
            <label>
              <i data-lucide="map-pin"></i>
              State
            </label>
            <input 
              type="text" 
              name="state" 
              required
              placeholder="Enter your state">
          </div>

          <!-- District -->
          <div class="form-field">
            <label>
              <i data-lucide="map-pin"></i>
              District
            </label>
            <input 
              type="text" 
              name="district" 
              required
              placeholder="Enter your district">
          </div>

          <!-- Password -->
          <div class="form-field">
            <label>
              <i data-lucide="lock"></i>
              Password
            </label>
            <div class="password-field">
              <input 
                type="password" 
                name="password" 
                required
                minlength="8"
                id="signupPassword"
                placeholder="Enter a password">
              <button type="button" class="toggle-password" onclick="togglePasswordVisibility('signupPassword')">
                <i data-lucide="eye"></i>
              </button>
            </div>
          </div>

          <!-- Confirm Password -->
          <div class="form-field">
            <label>
              <i data-lucide="lock"></i>
              Confirm Password
            </label>
            <div class="password-field">
              <input 
                type="password" 
                name="confirmPassword" 
                required
                minlength="8"
                id="confirmPassword"
                placeholder="Confirm your password">
              <button type="button" class="toggle-password" onclick="togglePasswordVisibility('confirmPassword')">
                <i data-lucide="eye"></i>
              </button>
            </div>
          </div>
        </div>

        <button type="submit">Sign Up</button>
      </form>
    </div>
  </div>

  <script src="js/main.js"></script>
  <script>
    lucide.createIcons();

    function togglePasswordVisibility(id) {
      const passwordField = document.getElementById(id);
      const type = passwordField.type === "password" ? "text" : "password";
      passwordField.type = type;
    }
  </script>
  <script>
    // Toggle password visibility
    function togglePasswordVisibility(passwordFieldId) {
      const passwordField = document.getElementById(passwordFieldId);
      const type = passwordField.type === 'password' ? 'text' : 'password';
      passwordField.type = type;
    }
  
    // Calculate Age based on Date of Birth
    document.querySelector('[name="dateOfBirth"]').addEventListener('change', function() {
      const dob = new Date(this.value);
      const age = new Date().getFullYear() - dob.getFullYear();
      document.querySelector('[name="age"]').value = age;
    });
  
    // Handle form submission
    async function submitSignupForm(event) {
      event.preventDefault();
  
      // Collect form data
      const formData = new FormData(document.getElementById('signupForm'));
      const data = Object.fromEntries(formData.entries());
  
      // Send form data to the backend
      try {
        const response = await fetch('http://localhost:3000/signup', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data),
        });
  
        if (response.ok) {
          alert('Sign up successful!');
          window.location.href = 'login.html';  // Redirect to login page after successful signup
        } else {
          const error = await response.json();
          alert(`Error: ${error.message}`);
        }
      } catch (err) {
        alert('Something went wrong!');
        console.error(err);
      }
    }
  
    // Attach event listener to the form
    document.getElementById('signupForm').addEventListener('submit', submitSignupForm);
  </script>
  
</body>
</html>
